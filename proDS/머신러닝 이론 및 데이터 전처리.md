# ProDS 머신러닝 이론 및 데이터 전처리

## 데이터 전처리

key words #요약변수 #파생변수 #이상치 #결측치 #binning



### 데이터 생성

- 요약변수

  - 수집된 정보를 분석의 목적에 맞게 종합한 변수

  - 많은 모델에 공통으로 사용될수 있어, 재활용성이 높음

    ex) 단어 빈도, 상품별 금액, 상품별 구매량, 영화 매출액 등

- 파생변수

  - 특정한 의미를 갖는 작위적 정의에 의한 변수

  - 사용자가 특정조건을 만족하거나 특정함수에 의해 값을 만들어 의미를 부여한 변수

  - 매우 주관적일 수 있으므로 논리적 타당성을 갖추어야함

    ex) 구매상품 다양성 변수, 가격 선호대 변수, 라이프스타일 변수, 영화인기도 변수 등

### 데이터 정제

- 결측값의 이해
  - 기록누락, 미응답, 수집오류 등의 이유로 결측이 발생
  - 결측값이 포함된 자료라도 나머지 변수의 값들은 의미있는 정보이므로, 정보의 손실을 최소화 하도록 결측을 처리하는 것이 바람직함
- 결측값 처리법
  - 완전제거법(list-wise deletion) (비추천 정보가 사라짐)
    - 결측값이 하나이상 포함된 자료를 제거하는 방법
    - 정보손실로 분석 결과가 왜곡될 수 있음
  - 평균대체법(mean value imputation) (많이 사용되는 방법)
    - 결측값을 해당 변수의 나머지 값들의 평균으로 대체하는 방법
    - 추정량의 표준오차가 과소추정되는 문제가 있음 (자료의 변동성이 작아질 수 있음)
  - 핫덱대체법(hot deck imputation)
    - 동일한 데이터 내에서 결측값이 발생한 관찰치와 유사한 특성을 가진 다른 관찰치의 정보를 이용하여 대체하는 방법
  - 그밖의 결측값 처리법
    - Regression imputation(변수간의 연관성이 있을거라는 가정하에 결측값을 계산하는 방법), 
    - KNN imputation(관찰치와 가장 유사한 k개의 observation을 찾고 결측치를 대체함) 등
- 이상값의 이해
  - 이상값은 다른 데이터와 동떨어진 것을 말함
  - 다른 자료값들에 비해 멀리 떨어져 있지만 의미가 있는 값일 수도 있고, 단순히 입력 오류로 발생한 값일 수도 있음
- 이상값의 탐지
  - 상자그림(box plot)
    - Q1-1.5 X IQR 과 Q3 + 1.5 X IQR의 범위를 넘어가는 자료를 이상값으로 진단 (1.5를 tukey의 계수라고 함)
  - 표준화 점수(Z-score)
    - 표준화 점수의 절대값이 2, 3보다 큰 경우를 이상값으로 진단
    - (자료 - 평균) / 표준편차 = z1 : 표준화점수로 정의
    - 표준화점수로 변하면 언제나 평균값은 0 표준편차는 1이 됨
- 이상값 처리 방법
  - 이상값 제외(trimming) : 처리는 간단하지만, 정보 손실이 발생하고, 추정량 왜곡이 생길 수 있음
  - 이상값 대체(winsorization) : 이상값을 정상값 중 최대 또는 최소 등으로 대체하는 방식
  - 변수 변환 : 자료값 전체에 로그변환, 제곱근 변환등을 적용(값의 범위를 좁혀줌)
  - 변수구간화(binning) : 연속형 변수를 구간을 이용하여 범주화 하는 과정(나이를 10대, 20대, 30대 등 변환하는 것)
    - 변수구간화의 효과
    - 이상치 문제를 완화
    - 결측치 처리방법이 될 수 있음
    - 변수간 관계가 단순화 되어 분석시 과적합을 방지할 수 있고, 결과 해석이 용이해짐



key words : #로그변환 #제곱근변환 #박스콕스 #이너조인 #레프트조인 #라이트조인 #풀아우터조인

### 데이터 변환

- 자료 변환을 통해 자료의 해석을 쉽고 풍부하게 하기 위한 과정
- 데이터 변환 목적
  - 분포의 대칭화
  - 선포를 비슷하게 하기 위하여
  - 변수 간 관계를 단순하게 하기 위하여
- 변환유형 1 : 제곱근 변환 vs 제곱 변환 (값의 범위를 조금만 바꿔야 할때)
  - 제곱근 변환 : 분포를 왼쪽으로 가져옴 (오른쪽 꼬리가 길때)
  - 제곱 변환 : 분포를 오른쪽으로 가져옴 (왼쪽 꼬리가 길때)
- 변환유형 2 : 로그 변환 vs 지수 변환 (값의 범위를 크게 바꿔야 할때)
  - 로그 변환 : 분포를 왼쪽으로 가져옴 (오른쪽 꼬리가 길때 꼬리를 잡아당김)
  - 지수 변환 : 분포를 오른쪽으로 가져옴 (왼쪽 꼬리가 길때 꼬리를 잡아당김)
- 박스콕스 변환(Box-Cox Transform)
  - p가 1보다 작을경우 제곱근 유형의 변환을 일반화
  - p가 0일경우
  - p가 1보다 클 경우 제곱 유형의 변환을 일반화



### 데이터 결합

- 이너조인(inner join)
  - 두 테이블에 키(key)가 공통으로 존재하는 레코드(record)만 결합
- 풀아우터조인(full outer join)(합집합, Union)
  - 두 테이블 중 어느 한쪽이라도 존재하는 키에 대한 레코드를 모두 결합
- 레프트조인(left join)
  - 왼쪽 테이블에 존재하는 키에 대한 레코드를 결합
- 라이트조인(right join)
  - 오른쪽 테이블에 존재하는 키에 대한 레코드를 결합

